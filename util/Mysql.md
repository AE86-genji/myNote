## 数据库引擎

查看引擎

```text
show engines;
```

**InnoDB**

InnoDB是MySQL默认的事务型引擎，也是最重要、最广泛的存储引擎。它的设计是用来处理大量短期事务，短期事务大部分是正常提交的，很少回滚。InnoDB的性能和自动崩溃恢复特性，使得它在非事务型存储的需求中，也很流行。除了非常特别的原因需要使用其他引擎，InnoDB也是非常好值得花时间研究的对象。

InnoDB的数据存储在表空间中，表空间是由InnoDB管理的黑盒文件系统，由一系列系统文件组成。InnoDB可以将每个表的数据和索引存放在单独的文件中。InnoDB也可以使用裸设备作为表空间存储介质。

InnoDB通过间隙锁（next-key locking）防止幻读的出现。InnoDB是基于聚簇索引建立，与其他存储引擎有很大的区别，聚簇索引对主键查询有很高的性能，不过它的二级索引（secondary ind ex，非主键索引）必须包含主键列。所以如果主键列很大的话，索引会很大。

**MyISAM**

在5.1之前，MyISAM是默认的引擎，MyISAM有大量的特心态，包括全文索引、压缩、空间函数。但是MyISAM不支持事务和行级锁，而且在崩溃后无法安全恢复。即使后续版本中MyISAM支持了事务，但是很多人的概念中依然是不支持事务的引擎。

## 基本数据类型

### 数值类型

|     类型     |                   大小                   |                        范围（有符号）                        |                        范围（无符号）                        |      用途      |
| :----------: | :--------------------------------------: | :----------------------------------------------------------: | :----------------------------------------------------------: | :------------: |
|   TINYINT    |                  1 字节                  |                         (-128，127)                          |                           (0，255)                           |    小整数值    |
|   SMALLINT   |                  2 字节                  |                      (-32 768，32 767)                       |                         (0，65 535)                          |    大整数值    |
|  MEDIUMINT   |                  3 字节                  |                   (-8 388 608，8 388 607)                    |                       (0，16 777 215)                        |    大整数值    |
| INT或INTEGER |                  4 字节                  |               (-2 147 483 648，2 147 483 647)                |                      (0，4 294 967 295)                      |    大整数值    |
|    BIGINT    |                  8 字节                  |   (-9,223,372,036,854,775,808，9 223 372 036 854 775 807)    |               (0，18 446 744 073 709 551 615)                |   极大整数值   |
|    FLOAT     |                  4 字节                  | (-3.402 823 466 E+38，-1.175 494 351 E-38)，0，(1.175 494 351 E-38，3.402 823 466 351 E+38) |         0，(1.175 494 351 E-38，3.402 823 466 E+38)          | 单精度浮点数值 |
|    DOUBLE    |                  8 字节                  | (-1.797 693 134 862 315 7 E+308，-2.225 073 858 507 201 4 E-308)，0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308) | 0，(2.225 073 858 507 201 4 E-308，1.797 693 134 862 315 7 E+308) | 双精度浮点数值 |
|   DECIMAL    | 对DECIMAL(M,D) ，如果M>D，为M+2否则为D+2 |                        依赖于M和D的值                        |                        依赖于M和D的值                        |     小数值     |

### 字符串类型

|  字符串类型  |                     字节大小                      |         描述及存储需求          |
| :----------: | :-----------------------------------------------: | :-----------------------------: |
|     CHAR     |                     0~255字节                     |           定长字符串            |
|   VARCHAR    |                     0~255字节                     |           变长字符串            |
|   TINYBLOB   |                     0~255字节                     | 不超过 255 个字符的二进制字符串 |
|   TINYTEXT   |                     0~255字节                     |          短文本字符串           |
|     BLOB     |                    0-65535字节                    |     二进制形式的长文本数据      |
|     TEXT     |                    0-65535字节                    |           长文本数据            |
|  MEDIUMBLOB  |                 0-16 777 215字节                  |  二进制形式的中等长度文本数据   |
|  MEDIUMTEXT  |                 0-16 777 215字节                  |        中等长度文本数据         |
|  LOGNGBLOB   |                0-4 294 967 295字节                |    二进制形式的极大文本数据     |
|   LONGTEXT   |                0-4 294 967 295字节                |          极大文本数据           |
| VARBINARY(M) | 允许长度0-M个字节的定长字节符串，值的长度+1个字节 |           定长字符串            |
|  BINARY(M)   |         M允许长度0-M个字节的定长字节符串          |           定长字符串            |

**BLOB 类型区分大小写，而 TEXT 不区分大小写。大小修饰符不用于各种 BLOB 和 TEXT 子类型。**

### 日期与时间类型

|   类型    | 大小(字节) |                  范围                   |          格式          |           用途           |
| :-------: | :--------: | :-------------------------------------: | :--------------------: | :----------------------: |
|   DATE    |     4      |          1000-01-01/9999-12-31          |       YYYY-MM-DD       |          日期值          |
|   TIME    |     3      |        '-838:59:59'/'838:59:59'         |        HH:MM:SS        |     时间值或持续时间     |
|   YEAR    |     1      |                1901/2155                |          YYYY          |          年份值          |
| DATETIME  |     8      | 1000-01-01 00:00:00/9999-12-31 23:59:59 |  YYYY-MM-DD HH:MM:SS   |     混合日期和时间值     |
| TIMESTAMP |     4      |        1970-01-01 00:00:00/2037         | 年某时 YYYYMMDD HHMMSS | 混合日期和时间值，时间戳 |

**DATE 类型的值应该使用连字号作为分隔符分开，而 TIME 类型的值应该使用冒号作为分隔符分开。**

### 枚举类型（ENUM）

ENUM 类型因为只允许在集合中取得一个值，有点类似于单选项。在处理相互排拆的数据时容易让人理解，比如人类的性别。

ENUM 类型字段可以从集合中取得一个值或使用 null 值， 除此之外的输入将会使 MySQL 在这个字段中插入一个空字符串。另外如果插入值的大小写与集合中值的大小写不匹配，MySQL 会自动使用插入值的大小写转换成与集合中大小写一致的值。  

  ENUM 类型在系统内部可以存储为数字，并且从 1 开始用数字做索引。一个 ENUM 类型最多可以包含 65536 个元素，其中一个元素被 MySQL 保留，用来存储错误信息， 这个错误值用索引 0 或者一个空字符串表示。

 MySQL 认为 ENUM 类型集合中出现的值是合法输入，除此之外其它任何输入都将失败。这说明通过搜索包含空字符串或对应数字索引为 0 的行就可以很容易地找到错误记录的位置。

### 集合类型（SET）

　SET 类型与 ENUM 类型相似但不相同。SET类型可以从预定义的集合中取得任意数量的值。并且与 ENUM 类型相同的是任何试图在 SET 类型字段中插入非预定义的值都会使MySQL 插入一个空字符串。如果插入一个即有合法的元素又有非法的元素的记录，MySQL 将会保留合法的元素，除去非法的元素。

## 数据库的使用

### 约束

|  关键字  |                           作用描述                           |         举例          |
| :------: | :----------------------------------------------------------: | :-------------------: |
|  unique  | 唯一性约束,表示这个字段不能出现重复的值, 用于唯一标识一条记录 | 例如身份证号码,学号等 |
| not null |              非空约束,表示这个字段的值不能为空               |     例如姓名,密码     |
|   null   |                一些数据类型默认就是可以为空的                |                       |
| default  |              默认值,用于给某一个字段设置默认值               |  gender enum("g","b   |

```mysql
#完整的建表语句
create table table_name(字段名称 字段类型[(宽度) 约束]) charset utf8;

#学生表 具备  姓名 性别 学号
create table student(
    #非空
    name char(20) not null,
    #默认值
    gender enum("g","b") default "b",
    #唯一
    id int  unique
)
#测试:
insert into student values(null,null,null);   # 错误原因是 name 不能为空
insert into student values("jack",null,null);  # 可以插入  null也是一个特殊的值  并且id的唯一约束 也可以为null
insert into student(name,id) values("jack",null); #可以插入 当没有给gender指定参数时,将使用默认值
alter table student modify id int unique not null; # 为已经存在的字段添加约束
```

### 主键

**从约束角度来看就等同于,非空+唯一**


在innodb存储引擎中 ,主键用于组织数据 (树形结构)

也就说主键对于innodb引擎来说是必须要的,没有不行!

如果没有手动指定主键 

mysql 会自动查找一个具备非空且唯一的字段作为主键

如果也没有也没有这样的字段,mysql会创建一个隐藏字段 作为主键 

首先明确主键是一种索引  unique也是,索引的作用是加速查询

如果我们在查询语句中没有使用索引字段 ,mysql将无法为我们的查询加速 意味着如果没有主键,将无法加速查询 

### 外键

外键约束,用于指向另一个表的主键字段  

